<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link href="./styles/home.css" rel="stylesheet" />
    <title>User Profile</title>
  </head>
  <body>
    <!--pre-cont-->

    <div class="loader"></div>

    <div class="opener">
      <img src="./images/stalker_logo.png" />
    </div>

    <!------------->

    <div class="area">

      <% if (setup === true) { %>
        <!--Setup-->

        <div class="q-container">
          <div class="prompt jost">
            <h2>Before you get started, we'll need a little more information:</h2>
          </div>
          <div class="setup_form">
            <form action="/user-setup" method="POST">
              <p class="jost">How should we refer to you?</p>
              <input class="name" type="text" name="name" placeholder="Name" maxlength="10" required>
              <input id="hiddenInput" type="text" name="selection" style="visibility: hidden;" value="">
              <p class="jost">What are you most interested in?</p>
              <div class="stock_options">
                <div class="top">
                  <input class="option jost" id="Crypto" type="button" value="Crypto">
                  <input class="option jost" id="Forex" type="button" value="Forex">
                  <input class="option jost" id="ETFs" type="button" value="ETFs">
                </div>
                <div class="bottom">
                  <input class="option jost" id="Index" type="button" value="Index">
                  <input class="option jost" id="Equities" type='button' value="Equities">
                </div>
              </div>
              <button class="jost sub" type="submit">Submit</button>
            </form>
          </div>
        </div>
      <% } else { %>
      <!--User Greet-->

      <div class="greet-container">
        <div class="greet">
          <div class="first jost-head">Welcome,</div><div class="second jost-head"><%= profile.rows[0].name %></div>
        </div>
        <div class="block"></div>
      </div>
      <% } %>

      

      

      <ul class="circles">
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </div>

    <script>
      /* pre-load content */

      window.addEventListener("load", () => {
        setTimeout(() => {
          document.querySelector(".loader").classList.add("hide");
        }, 700);

        setTimeout(() => {
          if (document.querySelector(".loader").classList.contains("hide")) {
            console.log("gotcha");
            setTimeout(() => {
              document.querySelector(".opener").classList.add("fade-in");
            }, 500);
            setTimeout(() => {
              document.querySelector(".opener").classList.remove("fade-in");
            }, 750);
            setTimeout(() => {
              document.querySelector(".opener").classList.add("hide");
              
            }, 1250);
            document.querySelector('.first').classList.add('first-ani');
            document.querySelector('.second').classList.add('second-ani');
          }
        }, 1250);
      });

      /*  setup  */

      function showLinks() {
        let links = document.querySelectorAll("input");
        links.forEach((link) => {
          link.classList.add("show-link");
        });
        document.querySelector('.sub').classList.add('show-link');
      }

      console.log(document.querySelectorAll(".option"));

      setTimeout(() => {
          showLinks();
      }, 2500)

      /* button switch */

      let selection = [];

      document.querySelectorAll('.option').forEach((option) => {
        option.addEventListener('click', () => {
          selection.push(option.value)
          document.getElementById('hiddenInput').value = selection[selection.length - 1]
          if (selection.length >= 2) {
            document.getElementById(selection[selection.length - 1]).classList.add('selected');
            document.getElementById(selection[selection.length - 2]).classList.remove('selected');
          } else {
            document.getElementById(selection).classList.add('selected');
          }
        })
               
      });
      
      /*  greeter  */
      
      setTimeout(() => {
        if (document.querySelector('.first').classList.contains('first-ani')) {
          document.querySelector('.greet-container').classList.add('hide');
        }
      }, 4000);

    </script>
  </body>
</html>
